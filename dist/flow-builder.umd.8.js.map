{"version":3,"sources":["webpack://flow-builder/./src/components/interaction-designer/block-types/MobilePrimitives_SelectOneResponseBlock.vue?964e","webpack://flow-builder/./src/components/interaction-designer/block-types/MobilePrimitives_SelectOneResponseBlock.vue?1385","webpack://flow-builder/./src/components/interaction-designer/block-types/MobilePrimitives_SelectOneResponseBlock.vue?4674","webpack://flow-builder/./src/components/interaction-designer/block-types/MobilePrimitives_SelectOneResponseBlock.vue","webpack://flow-builder/./src/store/flow/block-types/MobilePrimitives_SelectOneResponseBlockStore.ts"],"names":[],"mappings":"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","file":"flow-builder.umd.8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h3',{staticClass:\"no-room-above\"},[_vm._v(\" \"+_vm._s(_vm._f(\"trans\")('flow-builder.edit-block-type',{block_type: _vm.trans((\"flow-builder.\" + (_vm.block.type)))}))+\" \")]),_c('block-name-editor',{attrs:{\"block\":_vm.block}}),_c('block-label-editor',{attrs:{\"block\":_vm.block}}),_c('block-semantic-label-editor',{attrs:{\"block\":_vm.block}}),_c('div',{staticClass:\"prompt-resource\"},[(_vm.promptResource)?_c('resource-editor',{attrs:{\"label\":_vm._f(\"trans\")('flow-builder.prompt'),\"resource\":_vm.promptResource,\"block\":_vm.block,\"flow\":_vm.flow}}):_vm._e()],1),_c('div',{staticClass:\"question-prompt-resource\"},[(_vm.questionPromptResource)?_c('resource-editor',{attrs:{\"label\":_vm._f(\"trans\")('flow-builder.question-prompt'),\"resource\":_vm.questionPromptResource,\"block\":_vm.block,\"flow\":_vm.flow}}):_vm._e()],1),_c('div',{staticClass:\"choices-prompt-resource\"},[(_vm.choicesPromptResource)?_c('resource-editor',{attrs:{\"label\":_vm._f(\"trans\")('flow-builder.choices-prompt'),\"resource\":_vm.choicesPromptResource,\"block\":_vm.block,\"flow\":_vm.flow}}):_vm._e()],1),_vm._l((Object.keys(_vm.inflatedChoices)),function(choiceKey){return _c('div',{staticClass:\"form-group form-inline\"},[_c('resource-editor',{attrs:{\"label\":(\"Choice \" + choiceKey),\"resource\":_vm.inflatedChoices[choiceKey],\"block\":_vm.block,\"flow\":_vm.flow}})],1)}),_c('first-block-editor-button',{attrs:{\"flow\":_vm.flow,\"block-id\":_vm.block.uuid}}),_c('block-id',{attrs:{\"block\":_vm.block}})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {IFlow} from '@floip/flow-runner'\nimport ISelectOneResponseBlock from '@floip/flow-runner/src/model/block/ISelectOneResponseBlock'\nimport {\n  IResourceDefinition,\n} from '@floip/flow-runner/src/domain/IResourceResolver'\nimport Vue from 'vue'\nimport {namespace} from 'vuex-class'\nimport {Component, Prop, Watch} from 'vue-property-decorator'\n\nimport BlockNameEditor from '../block-editors/NameEditor.vue'\nimport BlockLabelEditor from '../block-editors/LabelEditor.vue'\nimport BlockSemanticLabelEditor from '../block-editors/SemanticLabelEditor.vue'\n\nimport FirstBlockEditorButton from '../flow-editors/FirstBlockEditorButton.vue'\nimport ResourceEditor from '../resource-editors/ResourceEditor.vue'\nimport BlockId from '../block-editors/BlockId.vue'\n\nimport SelectOneStore, {BLOCK_TYPE} from '@/store/flow/block-types/MobilePrimitives_SelectOneResponseBlockStore'\nimport lang from '@/lib/filters/lang'\nimport {createDefaultBlockTypeInstallerFor} from \"@/store/builder\";\n\nconst flowVuexNamespace = namespace('flow')\nconst blockVuexNamespace = namespace(`flow/${BLOCK_TYPE}`)\n\n@Component<any>({\n  components: {\n    BlockNameEditor,\n    BlockLabelEditor,\n    BlockSemanticLabelEditor,\n    FirstBlockEditorButton,\n    ResourceEditor,\n    BlockId,\n  },\n  mixins: [lang],\n})\nexport class MobilePrimitives_SelectOneResponseBlock extends Vue {\n  @Prop()readonly block!: ISelectOneResponseBlock\n  @Prop()readonly flow!: IFlow\n\n  get promptResource(): IResourceDefinition {\n    return this.resourcesByUuid[this.block.config.prompt]\n  }\n  get questionPromptResource(): IResourceDefinition {\n    return this.resourcesByUuid[this.block.config.questionPrompt || \"\"]\n  }\n  get choicesPromptResource(): IResourceDefinition {\n    return this.resourcesByUuid[this.block.config.choicesPrompt || \"\"]\n  }\n\n  @Watch('inflatedChoices', {deep: true})\n  onChoicesChanged(newChoices: object) {\n    this.editSelectOneResponseBlockChoice()\n  }\n\n  @flowVuexNamespace.Getter resourcesByUuid!: {[key: string]: IResourceDefinition}\n  @blockVuexNamespace.Getter inflatedChoices!: {[key: string]: IResourceDefinition}\n  @blockVuexNamespace.Action editSelectOneResponseBlockChoice!: () => Promise<object>\n}\n\nexport default MobilePrimitives_SelectOneResponseBlock\nexport const install = createDefaultBlockTypeInstallerFor(BLOCK_TYPE, SelectOneStore)\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MobilePrimitives_SelectOneResponseBlock.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MobilePrimitives_SelectOneResponseBlock.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MobilePrimitives_SelectOneResponseBlock.vue?vue&type=template&id=8ef63946&\"\nimport script from \"./MobilePrimitives_SelectOneResponseBlock.vue?vue&type=script&lang=ts&\"\nexport * from \"./MobilePrimitives_SelectOneResponseBlock.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {ActionTree, GetterTree, MutationTree} from 'vuex'\nimport {IFlowsState} from '../index'\nimport {IRootState} from '@/store'\nimport {\n  IBlockExitTestRequired,\n  IBlockExit,\n  IFlow,\n  IContext,\n  SupportedContentType,\n  findBlockOnActiveFlowWith,\n  IResourceDefinitionContentTypeSpecific,\n} from '@floip/flow-runner'\nimport IdGeneratorUuidV4 from '@floip/flow-runner/dist/domain/IdGeneratorUuidV4'\nimport ISelectOneResponseBlock from '@floip/flow-runner/dist/model/block/ISelectOneResponseBlock'\nimport {IResourceDefinitionVariantOverModesFilter} from '../resource'\nimport {\n  IResourceDefinition,\n} from '@floip/flow-runner/src/domain/IResourceResolver'\nimport Vue from 'vue'\nimport {defaults, find, max} from 'lodash'\n\nexport const BLOCK_TYPE = 'MobilePrimitives\\\\SelectOneResponse'\n\nimport { someItemsHaveValue, allItemsHaveValue, twoItemsBlank } from '../utils/listBuilder'\n\nexport const getters: GetterTree<IFlowsState, IRootState> = {\n  inflatedChoices: (state, getters, rootState, rootGetters): object => {\n    const currentBlock = rootGetters['builder/activeBlock']\n    let choices: {[key: string]: IResourceDefinition} = {}\n    return Object.keys(currentBlock.config.choices).reduce((memo, choiceKey): {[key: string]: IResourceDefinition} => {\n      memo[choiceKey] = rootGetters['flow/resourcesByUuid'][currentBlock.config.choices[choiceKey]]\n      return memo\n    }, choices)\n  },\n  allChoicesHaveContent: (state, getters): boolean => {\n    return Object.keys(getters.inflatedChoices).every((key: string) => {\n      return someItemsHaveValue(getters.inflatedChoices[key].values, \"value\")\n    })\n  },\n  twoChoicesBlank: (state, getters, rootState, rootGetters): boolean => {\n    let blankNumber = 0\n    return Object.keys(getters.inflatedChoices).some((key: string) => {\n\n      if (!someItemsHaveValue(getters.inflatedChoices[key].values, \"value\")) {\n        blankNumber += 1\n      }\n\n      if (blankNumber > 1) {\n        return true\n      }\n\n      return false\n    })\n  },\n\n}\n\nexport const mutations: MutationTree<IFlowsState> = {\n  deleteChoiceByKey(state, {choiceKeyToRemove, blockId}) {\n    //TODO - this shouldn't be necessary\n    // @ts-ignore - TS2339: Property 'flow' does not exist on type\n    const block: ISelectOneResponseBlock = findBlockOnActiveFlowWith(blockId, this.state.flow as unknown as IContext) as ISelectOneResponseBlock\n    delete block.config.choices[choiceKeyToRemove]\n    let choices: {[key: string]: string} = {}\n    //rekey\n    block.config.choices = Object.keys(block.config.choices).sort().reduce((choices, choiceKey: string, index: number) => {\n      choices[index+1] = block.config.choices[choiceKey]\n      return choices\n    }, choices)\n  },\n  pushNewChoice(state, {choiceId, blockId, newIndex}) {\n    //TODO - this shouldn't be necessary\n    // @ts-ignore - TS2339: Property 'flow' does not exist on type\n    const block: ISelectOneResponseBlock = findBlockOnActiveFlowWith(blockId, this.state.flow as unknown as IContext) as ISelectOneResponseBlock\n    block.config.choices[newIndex] = choiceId\n  }\n}\n\nexport const actions: ActionTree<IFlowsState, IRootState> = {\n  async popFirstEmptyChoice({commit, rootGetters, getters}) {\n    const choiceToRemove = find(Object.keys(getters.inflatedChoices), (key: string) => {\n      return !someItemsHaveValue(getters.inflatedChoices[key].values, \"value\")\n    })\n    if (choiceToRemove) {\n      commit('deleteChoiceByKey', {choiceKeyToRemove: choiceToRemove, blockId: rootGetters['builder/activeBlock'].uuid})\n      return rootGetters['builder/activeBlock'].config.choices[choiceToRemove]\n    }\n    return null\n  },\n  async editSelectOneResponseBlockChoice({commit, dispatch, getters, rootGetters}) {\n    const activeBlock = rootGetters['builder/activeBlock']\n    if (getters.allChoicesHaveContent) {\n      const newIndex = parseInt(max(Object.keys(activeBlock.config.choices)) || \"0\")+1\n      const blankResource = await dispatch('flow/flow_addBlankResourceForEnabledModesAndLangs', null, {root: true})\n      //due to a race condition we may have already pushed something\n      if(!activeBlock.config.choices[newIndex]) {\n        commit('pushNewChoice', {choiceId: blankResource.uuid, blockId: activeBlock.uuid, newIndex})\n        const exit: IBlockExitTestRequired = await dispatch('flow/block_createBlockExitWith', {\n          props: ({\n            uuid: (new IdGeneratorUuidV4()).generate(),\n            test: 'block.value = '+(newIndex-1),\n            label: blankResource.uuid\n          }) as IBlockExitTestRequired,\n        }, {root: true})\n        commit('flow/block_pushNewExit', {blockId: activeBlock.uuid, newExit: exit}, {root: true})\n      }\n    } else if (getters.twoChoicesBlank) {\n      const exitLabel = await dispatch('popFirstEmptyChoice', {blockId: activeBlock.uuid})\n      if(exitLabel) {\n        commit('flow/block_popExitsByLabel', {blockId: activeBlock.uuid, exitLabel}, {root: true})\n      }\n    }\n    return activeBlock.config.choices\n  },\n\n  // todo: in the flow-spec, there's mention that we can configure to swap between exit-per-choice and a default exit\n  //       but, it doesn't seem to mention how this is configured\n  async createWith({state, commit, dispatch}, {props}: {props: {uuid: string} & Partial<ISelectOneResponseBlock>}) {\n    const blankResource = await dispatch('flow/flow_addBlankResourceForEnabledModesAndLangs', null, {root: true})\n    const blankPromptResource = await dispatch('flow/flow_addBlankResourceForEnabledModesAndLangs', null, {root: true})\n    const blankQuestionPromptResource = await dispatch('flow/flow_addBlankResourceForEnabledModesAndLangs', null, {root: true})\n    const blankChoicesPromptResource = await dispatch('flow/flow_addBlankResourceForEnabledModesAndLangs', null, {root: true})\n\n    const defaultExitProps: Partial<IBlockExit> = {\n      uuid: (new IdGeneratorUuidV4).generate(),\n      tag: 'Default',\n      label: 'Default',\n    }\n\n    const errorExitProps: Partial<IBlockExit> = {\n      uuid: (new IdGeneratorUuidV4).generate(),\n      tag: 'Error',\n      label: 'Error',\n    }\n\n    return defaults(props, {\n      type: BLOCK_TYPE,\n      name: '',\n      label: '',\n      semanticLabel: '',\n      exits: [\n        await dispatch('flow/block_createBlockDefaultExitWith', {props: defaultExitProps}, {root: true}),\n        await dispatch('flow/block_createBlockExitWith', {props: errorExitProps}, {root: true}),\n      ],\n      config: {\n        prompt: blankPromptResource.uuid,\n        questionPrompt: blankQuestionPromptResource.uuid,\n        choicesPrompt: blankChoicesPromptResource.uuid,\n        choices: {'1': blankResource.uuid},\n      },\n    })\n  }\n,\n\n}\n\nexport default {\n  namespaced: true,\n  getters,\n  mutations,\n  actions,\n}\n"],"sourceRoot":""}
(("undefined"!==typeof self?self:this)["webpackJsonpflow_builder"]=("undefined"!==typeof self?self:this)["webpackJsonpflow_builder"]||[]).push([[7],{"5c47":function(e,t,o){"use strict";o.r(t),o.d(t,"MobilePrimitives_SelectOneResponseBlock",(function(){return z})),o.d(t,"install",(function(){return J}));var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mobile-primitive-select-one-response-block"},[o("h3",{staticClass:"no-room-above"},[e._v(" "+e._s(e._f("trans")("flow-builder."+e.block.type))+" ")]),o("fieldset",{attrs:{disabled:!e.isEditable}},[o("block-label-editor",{attrs:{block:e.block},on:{gearClicked:function(t){e.showSemanticLabel=!e.showSemanticLabel}}}),e.showSemanticLabel?o("block-semantic-label-editor",{attrs:{block:e.block}}):e._e(),o("block-name-editor",{attrs:{block:e.block}}),o("hr"),o("choices-builder",{attrs:{block:e.block},on:{choiceChanged:e.handleChoiceChanged}}),o("block-output-branching-config",{attrs:{block:e.block,"has-exit-per-choice":!0,"label-class":""},on:{branchingTypeChanged:function(t){return e.reflowExitsWhenSwitchingToBranchingTypeNotUnified()}}}),o("div",{staticClass:"prompt-resource"},[e.promptResource?o("resource-editor",{attrs:{label:e._f("trans")("flow-builder.prompt"),resource:e.promptResource,block:e.block,flow:e.flow}}):e._e()],1),e._t("extras"),o("categorization",{attrs:{block:e.block}}),o("generic-contact-property-editor",{attrs:{block:e.block}}),o("hr"),o("first-block-editor-button",{attrs:{flow:e.flow,"block-id":e.block.uuid}})],2),o("block-id",{attrs:{block:e.block}})],1)},r=[],i=o("276c"),a=o("e954"),n=o("2c4c"),s=o("920b"),u=o("92a6"),d=o("fc11"),l=(o("99af"),o("9ab4")),b=o("9300"),f=o("4bb5"),h=o("1b40"),p=o("2ef0"),O=o("ecef"),j=o("4a51"),k=o("8619"),v=o("af98"),m=o("2fe1"),y=o("bb40"),w=o("393e"),_=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"choices-builder form-group"},[o("h4",[e._v(e._s(e._f("trans")("flow-builder.choices")))]),e._l(e.choiceResourcesOrderedByResourcesList,(function(t,c){return[o("resource-variant-text-editor",{key:t.uuid,ref:"choices",refInFor:!0,staticClass:"choices-builder-item",attrs:{label:(c+1).toString(),rows:1,placeholder:"Enter choice...","resource-id":t.uuid,"resource-variant":t.values[0],mode:e.SupportedMode.TEXT},on:{afterResourceVariantChanged:function(o){return e.handleExistingResourceVariantChangedFor(t.uuid,c,t)}}})]})),e.draftResource?o("resource-variant-text-editor",{key:e.draftResource.uuid,ref:"draftChoice",staticClass:"choices-builder-item",attrs:{label:(e.choiceResourcesOrderedByResourcesList.length+1).toString(),rows:1,placeholder:"Enter choice...","resource-id":e.draftResource.uuid,"resource-variant":e.findOrGenerateStubbedVariantOn(e.draftResource,{language_id:e.activeFlow.languages[0].id,content_type:e.SupportedContentType.TEXT,modes:[e.SupportedMode.TEXT]}),mode:e.SupportedMode.TEXT},on:{beforeResourceVariantChanged:e.addDraftResourceToChoices,afterResourceVariantChanged:function(t){return e.rewriteChoiceKeyFor({resourceId:e.draftResource.uuid,blockId:e.block.uuid})}}}):e._e()],2)},g=[],x=o("c964"),C=(o("96cf"),o("07ac"),o("e260"),o("d3b7"),o("ddb0"),o("31aa")),R=Object(f["e"])("flow"),E=Object(f["e"])("flow/".concat(O["a"])),I=function(e){Object(s["a"])(o,e);var t=Object(u["a"])(o);function o(){var e;Object(i["a"])(this,o);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),Object(d["a"])(Object(n["a"])(e),"block",void 0),Object(d["a"])(Object(n["a"])(e),"draftResource",null),Object(d["a"])(Object(n["a"])(e),"SupportedContentType",b["SupportedContentType"]),Object(d["a"])(Object(n["a"])(e),"SupportedMode",b["SupportedMode"]),Object(d["a"])(Object(n["a"])(e),"findOrGenerateStubbedVariantOn",w["c"]),Object(d["a"])(Object(n["a"])(e),"resources",void 0),Object(d["a"])(Object(n["a"])(e),"resourcesByUuid",void 0),Object(d["a"])(Object(n["a"])(e),"activeFlow",void 0),Object(d["a"])(Object(n["a"])(e),"resource_add",void 0),Object(d["a"])(Object(n["a"])(e),"resource_createWith",void 0),Object(d["a"])(Object(n["a"])(e),"deleteChoiceByResourceIdFrom",void 0),Object(d["a"])(Object(n["a"])(e),"rewriteChoiceKeyFor",void 0),Object(d["a"])(Object(n["a"])(e),"addChoiceByResourceIdTo",void 0),e}return Object(a["a"])(o,[{key:"choiceResourcesOrderedByResourcesList",get:function(){var e=Object.values(this.block.config.choices);return Object(p["intersectionWith"])(this.resources,e,(function(e,t){return e.uuid===t}))}},{key:"created",value:function(){this.generateDraftResource()}},{key:"generateDraftResource",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,(new C["IdGeneratorUuidV4"]).generate();case 3:return e.t1=e.sent,e.t2={uuid:e.t1},e.t3={props:e.t2},e.next=8,e.t0.resource_createWith.call(e.t0,e.t3);case 8:this.draftResource=e.sent;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addDraftResourceToChoices",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.draftResource){e.next=3;break}return console.warn("interaction-designer/block-editors/ChoicesBuilder","Unable to add absent draft resource to block choices.",{block:this.block}),e.abrupt("return");case 3:return this.resource_add({resource:this.draftResource}),this.addChoiceByResourceIdTo({blockId:this.block.uuid,resourceId:this.draftResource.uuid}),this.$nextTick((function(){return t.focusInputElFor(Object(p["last"])(t.$refs.choices))})),e.next=8,this.generateDraftResource();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"focusInputElFor",value:function(e){null===e||void 0===e||e.$refs.input.focus()}},{key:"handleExistingResourceVariantChangedFor",value:function(e,t,o){var c=t===this.choiceResourcesOrderedByResourcesList.length-1,r=Object(p["isEmpty"])(Object(p["get"])(o.values[0],"value"));if(c&&r)return this.deleteChoiceByResourceIdFrom({blockId:this.block.uuid,resourceId:e}),void this.focusInputElFor(this.$refs.draftChoice);this.rewriteChoiceKeyFor({resourceId:e,blockId:this.block.uuid}),this.$emit("choiceChanged",{resourceId:e,choiceIndex:t,resource:o})}}]),o}(Object(m["c"])(j["a"]));Object(l["__decorate"])([Object(h["b"])()],I.prototype,"block",void 0),Object(l["__decorate"])([R.State],I.prototype,"resources",void 0),Object(l["__decorate"])([R.Getter],I.prototype,"resourcesByUuid",void 0),Object(l["__decorate"])([R.Getter],I.prototype,"activeFlow",void 0),Object(l["__decorate"])([R.Mutation],I.prototype,"resource_add",void 0),Object(l["__decorate"])([R.Action],I.prototype,"resource_createWith",void 0),Object(l["__decorate"])([E.Action],I.prototype,"deleteChoiceByResourceIdFrom",void 0),Object(l["__decorate"])([E.Action],I.prototype,"rewriteChoiceKeyFor",void 0),Object(l["__decorate"])([E.Action],I.prototype,"addChoiceByResourceIdTo",void 0),I=Object(l["__decorate"])([Object(h["a"])({components:{ResourceVariantTextEditor:y["a"]}})],I);var B=I,T=B,S=o("2877"),F=Object(S["a"])(T,_,g,!1,null,null,null),V=F.exports,U=o("18b0"),L=o("f04e"),G=o("3411"),A=o("1b4e"),M=o("70f0"),W=o("192b"),D=o("510a"),$=o("792f"),K=o("b4ec"),P=Object(f["e"])("flow"),X=Object(f["e"])("flow/".concat(O["a"])),N=Object(f["e"])("builder"),z=function(e){Object(s["a"])(o,e);var t=Object(u["a"])(o);function o(){var e;Object(i["a"])(this,o);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),Object(d["a"])(Object(n["a"])(e),"block",void 0),Object(d["a"])(Object(n["a"])(e),"flow",void 0),Object(d["a"])(Object(n["a"])(e),"showSemanticLabel",!1),Object(d["a"])(Object(n["a"])(e),"SupportedContentType",b["SupportedContentType"]),Object(d["a"])(Object(n["a"])(e),"SupportedMode",b["SupportedMode"]),Object(d["a"])(Object(n["a"])(e),"findOrGenerateStubbedVariantOn",w["c"]),Object(d["a"])(Object(n["a"])(e),"resourcesByUuid",void 0),Object(d["a"])(Object(n["a"])(e),"block_createBlockExitWith",void 0),Object(d["a"])(Object(n["a"])(e),"reflowExitsFromChoices",void 0),Object(d["a"])(Object(n["a"])(e),"isEditable",void 0),e}return Object(a["a"])(o,[{key:"promptResource",get:function(){return this.resourcesByUuid[this.block.config.prompt]}},{key:"handleChoiceChanged",value:function(){var e=this.block,t=e.uuid,o=e.vendor_metadata,c=U["b"].EXIT_PER_CHOICE;o.io_viamo.branchingType===c&&this.reflowExitsFromChoices({blockId:t})}},{key:"reflowExitsWhenSwitchingToBranchingTypeNotUnified",value:function(){var e=this.block,t=e.uuid,o=e.vendor_metadata,c=U["b"].EXIT_PER_CHOICE,r=U["b"].ADVANCED,i=Object(p["includes"])([c,r],o.io_viamo.branchingType);i&&this.reflowExitsFromChoices({blockId:t})}}]),o}(Object(m["c"])(j["a"]));Object(l["__decorate"])([Object(h["b"])()],z.prototype,"block",void 0),Object(l["__decorate"])([Object(h["b"])()],z.prototype,"flow",void 0),Object(l["__decorate"])([P.Getter],z.prototype,"resourcesByUuid",void 0),Object(l["__decorate"])([P.Action],z.prototype,"block_createBlockExitWith",void 0),Object(l["__decorate"])([X.Action],z.prototype,"reflowExitsFromChoices",void 0),Object(l["__decorate"])([N.Getter],z.prototype,"isEditable",void 0),z=Object(l["__decorate"])([Object(h["a"])({components:{GenericContactPropertyEditor:K["a"],ResourceVariantTextEditor:y["a"],BlockExitSemanticLabelEditor:M["a"],BlockId:$["a"],BlockLabelEditor:G["a"],BlockNameEditor:L["a"],BlockOutputBranchingConfig:U["c"],BlockSemanticLabelEditor:A["a"],ChoicesBuilder:V,FirstBlockEditorButton:W["a"],ResourceEditor:D["a"],Categorization:k["a"]}})],z);var H=z,J=Object(v["d"])(O["a"],O["c"]),q=H,Q=Object(S["a"])(q,c,r,!1,null,null,null);t["default"]=Q.exports},"70f0":function(e,t,o){"use strict";var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("text-editor",{attrs:{"is-editable":e.isEditable,label:e._f("trans")("flow-builder.block-exit-semantic-label"),placeholder:e._f("trans")("flow-builder.enter-block-exit-semantic-label")},model:{value:e.semanticLabel,callback:function(t){e.semanticLabel=t},expression:"semanticLabel"}})],1)},r=[],i=o("f3f3"),a=o("2f62"),n=o("d883"),s=o("4a51"),u={components:{TextEditor:n["a"]},mixins:[s["b"]],props:{isEditable:{default:!0,type:Boolean},exit:{type:Object,required:!0}},computed:{semanticLabel:{get:function(){return this.exit.semantic_label},set:function(e){this.exit.semantic_label=e,this.$emit("commitSemanticLabel",e)}}},methods:Object(i["a"])({},Object(a["c"])("flow",["block_setExitSemanticLabel"]))},d=u,l=o("2877"),b=Object(l["a"])(d,c,r,!1,null,null,null);t["a"]=b.exports},ecef:function(e,t,o){"use strict";o.d(t,"a",(function(){return d})),o.d(t,"f",(function(){return l})),o.d(t,"d",(function(){return b})),o.d(t,"e",(function(){return f})),o.d(t,"b",(function(){return h}));var c=o("d0ff"),r=o("c964"),i=(o("96cf"),o("e260"),o("d3b7"),o("ddb0"),o("99af"),o("b64b"),o("fb6a"),o("e6cf"),o("3ca3"),o("d81d"),o("cca6"),o("a434"),o("9300")),a=o("31aa"),n=o("8bbf"),s=o.n(n),u=o("2ef0"),d="MobilePrimitives.SelectOneResponse",l=function(){return{}},b={},f={},h={rewriteChoiceKeyFor:function(e,t){var o=e.rootGetters,c=e.dispatch,r=t.resourceId,a=t.blockId,n=o["builder/blocksById"][a];if(null==n)throw new i["ValidationException"]("Unable to find block: ".concat(a));var s=o["flow/resourcesByUuid"][r];if(null==s)throw new i["ValidationException"]("Unable to find resource for choice: ".concat(r));var d=String(Object(u["findKey"])(n.config.choices,(function(e){return e===r})));n.config.choices=Object(u["omit"])(n.config.choices,d),c("addChoiceByResourceIdTo",{blockId:a,resourceId:r})},addChoiceByResourceIdTo:function(e,t){var o=e.rootGetters,c=t.blockId,r=t.resourceId,a=o["builder/blocksById"][c];if(null==a)throw new i["ValidationException"]("Unable to find block: ".concat(c));var n=o["flow/resourcesByUuid"][r];if(null==n)throw new i["ValidationException"]("Unable to find resource for choice: ".concat(r));var d=Object(u["snakeCase"])(Object(u["get"])(n.values[0],"value"))||n.uuid,l=d in a.config.choices,b=l?"-".concat(n.uuid):"";s.a.set(a.config.choices,"".concat(d).concat(b),n.uuid)},deleteChoiceByResourceIdFrom:function(e,t){var o=e.rootGetters,c=t.blockId,r=t.resourceId,a=o["builder/blocksById"][c];if(null==a)throw new i["ValidationException"]("Unable to find block: ".concat(c));var n=String(Object(u["findKey"])(a.config.choices,(function(e){return e===r})));s.a.delete(a.config.choices,n)},reflowExitsFromChoices:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function o(){var n,s,u,d,l,b,f,h;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=e.dispatch,s=e.rootGetters,u=t.blockId,d=s["builder/blocksById"][u],null!=d){o.next=5;break}throw new i["ValidationException"]("Unable to find block: ".concat(u));case 5:return l=d.config.choices,b=d.exits,f=Object.keys(l),h=b.slice(0,-1),o.next=10,Promise.all(f.map(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,o){var c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=h[o]){e.next=8;break}return e.next=3,(new a["IdGeneratorUuidV4"]).generate();case 3:return c=e.sent,e.next=6,n("flow/block_createBlockExitWith",{props:{uuid:c}},{root:!0});case 6:r=e.sent,h.push(r);case 8:Object.assign(h[o],{name:t,test:"block.value = ".concat(o+1)});case 9:case"end":return e.stop()}}),e)})));return function(t,o){return e.apply(this,arguments)}}()));case 10:b.splice.apply(b,[0,b.length-1].concat(Object(c["a"])(h)));case 11:case"end":return o.stop()}}),o)})))()},createWith:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function o(){var c,r,i,n,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c=e.dispatch,r=t.props,o.next=4,c("flow/flow_addBlankResourceForEnabledModesAndLangs",null,{root:!0});case 4:return i=o.sent,o.next=7,(new a["IdGeneratorUuidV4"]).generate();case 7:return o.t0=o.sent,n={uuid:o.t0,name:"Default",default:!0},o.next=11,c("flow/block_createBlockDefaultExitWith",{props:n},{root:!0});case 11:return s=o.sent,o.abrupt("return",Object(u["defaultsDeep"])(r,{type:d,name:"",label:"",semantic_label:"",config:{prompt:i.uuid,choices:{}},exits:[s],tags:[]}));case 13:case"end":return o.stop()}}),o)})))()}};t["c"]={namespaced:!0,state:l,getters:b,mutations:f,actions:h}}}]);
//# sourceMappingURL=flow-builder.umd.min.7.js.map
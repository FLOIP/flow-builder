(("undefined"!==typeof self?self:this)["webpackJsonpflow_builder"]=("undefined"!==typeof self?self:this)["webpackJsonpflow_builder"]||[]).push([[6,7],{"03d5":function(e,t,o){"use strict";o.r(t),o.d(t,"MobilePrimitives_SelectManyResponseBlock",(function(){return L})),o.d(t,"install",(function(){return G}));var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mobile-primitive-select-many-response-block"},[o("h3",{staticClass:"no-room-above"},[e._v(" "+e._s(e._f("trans")("flow-builder.edit-block-type",{block_type:e.trans("flow-builder."+e.block.type)}))+" ")]),o("fieldset",{attrs:{disabled:!e.isEditable}},[o("block-label-editor",{attrs:{block:e.block},on:{gearClicked:function(t){e.showSemanticLabel=!e.showSemanticLabel}}}),e.showSemanticLabel?o("block-semantic-label-editor",{attrs:{block:e.block}}):e._e(),o("block-name-editor",{attrs:{block:e.block}}),o("div",{staticClass:"prompt-resource"},[e.promptResource?o("resource-editor",{attrs:{label:e._f("trans")("flow-builder.prompt"),resource:e.promptResource,block:e.block,flow:e.flow}}):e._e()],1),o("hr"),o("choices-builder",{attrs:{block:e.block}}),o("block-output-branching-config",{attrs:{block:e.block}}),e._t("extras"),o("categorization",{attrs:{block:e.block}}),o("generic-contact-property-editor",{attrs:{block:e.block}}),o("hr"),o("first-block-editor-button",{attrs:{flow:e.flow,"block-id":e.block.uuid}})],2),o("block-id",{attrs:{block:e.block}})],1)},r=[],a=o("276c"),i=o("2c4c"),n=o("920b"),s=o("92a6"),l=o("fc11"),u=(o("99af"),o("9ab4")),d=o("1b40"),b=o("c964"),f=o("f3f3"),p=(o("96cf"),o("31aa")),h=o("2ef0"),k=o("ecef"),O="MobilePrimitives.SelectManyResponse",j=Object(f["a"])({},k["d"]),v=Object(f["a"])({},k["e"]),m=Object(f["a"])(Object(f["a"])({},k["b"]),{},{createWith:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function o(){var c,r,a,i,n;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c=e.dispatch,r=t.props,o.next=4,c("flow/flow_addBlankResourceForEnabledModesAndLangs",null,{root:!0});case 4:return a=o.sent,o.next=7,(new p["IdGeneratorUuidV4"]).generate();case 7:return o.t0=o.sent,i={uuid:o.t0,name:"Default",default:!0},o.next=11,c("flow/block_createBlockDefaultExitWith",{props:i},{root:!0});case 11:return n=o.sent,o.abrupt("return",Object(h["defaultsDeep"])(r,{type:O,name:"",label:"",semantic_label:"",exits:[n],config:{prompt:a.uuid,choices:{}},vendor_metadata:{},tags:[]}));case 13:case"end":return o.stop()}}),o)})))()}}),_={namespaced:!0,state:k["f"],getters:j,mutations:v,actions:m},y=o("4bb5"),w=o("af98"),g=o("8619"),E=o("f04e"),x=o("3411"),C=o("1b4e"),R=o("70f0"),B=o("192b"),I=o("510a"),T=o("792f"),S=o("5c47"),F=o("b4ec"),U=(Object(y["e"])("flow/".concat(O)),Object(y["e"])("builder")),L=function(e){Object(n["a"])(o,e);var t=Object(s["a"])(o);function o(){var e;Object(a["a"])(this,o);for(var c=arguments.length,r=new Array(c),n=0;n<c;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(l["a"])(Object(i["a"])(e),"showSemanticLabel",!1),e}return o}(S["default"]);Object(u["__decorate"])([U.Getter],L.prototype,"isEditable",void 0),L=Object(u["__decorate"])([Object(d["a"])({components:{GenericContactPropertyEditor:F["a"],BlockNameEditor:E["a"],BlockLabelEditor:x["a"],BlockSemanticLabelEditor:C["a"],BlockExitSemanticLabelEditor:R["a"],FirstBlockEditorButton:B["a"],ResourceEditor:I["a"],BlockId:T["a"],Categorization:g["a"]}})],L);var V=L,G=Object(w["d"])(O,_),M=V,A=o("2877"),D=Object(A["a"])(M,c,r,!1,null,null,null);t["default"]=D.exports},"5c47":function(e,t,o){"use strict";o.r(t),o.d(t,"MobilePrimitives_SelectOneResponseBlock",(function(){return z})),o.d(t,"install",(function(){return J}));var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mobile-primitive-select-one-response-block"},[o("h3",{staticClass:"no-room-above"},[e._v(" "+e._s(e._f("trans")("flow-builder."+e.block.type))+" ")]),o("fieldset",{attrs:{disabled:!e.isEditable}},[o("block-label-editor",{attrs:{block:e.block},on:{gearClicked:function(t){e.showSemanticLabel=!e.showSemanticLabel}}}),e.showSemanticLabel?o("block-semantic-label-editor",{attrs:{block:e.block}}):e._e(),o("block-name-editor",{attrs:{block:e.block}}),o("hr"),o("choices-builder",{attrs:{block:e.block},on:{choiceChanged:e.handleChoiceChanged}}),o("block-output-branching-config",{attrs:{block:e.block,"has-exit-per-choice":!0,"label-class":""},on:{branchingTypeChanged:function(t){return e.reflowExitsWhenSwitchingToBranchingTypeNotUnified()}}}),o("div",{staticClass:"prompt-resource"},[e.promptResource?o("resource-editor",{attrs:{label:e._f("trans")("flow-builder.prompt"),resource:e.promptResource,block:e.block,flow:e.flow}}):e._e()],1),e._t("extras"),o("categorization",{attrs:{block:e.block}}),o("generic-contact-property-editor",{attrs:{block:e.block}}),o("hr"),o("first-block-editor-button",{attrs:{flow:e.flow,"block-id":e.block.uuid}})],2),o("block-id",{attrs:{block:e.block}})],1)},r=[],a=o("276c"),i=o("e954"),n=o("2c4c"),s=o("920b"),l=o("92a6"),u=o("fc11"),d=(o("99af"),o("9ab4")),b=o("9300"),f=o("4bb5"),p=o("1b40"),h=o("2ef0"),k=o("ecef"),O=o("4a51"),j=o("8619"),v=o("af98"),m=o("2fe1"),_=o("bb40"),y=o("393e"),w=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"choices-builder form-group"},[o("h4",[e._v(e._s(e._f("trans")("flow-builder.choices")))]),e._l(e.choiceResourcesOrderedByResourcesList,(function(t,c){return[o("resource-variant-text-editor",{key:t.uuid,ref:"choices",refInFor:!0,staticClass:"choices-builder-item",attrs:{label:(c+1).toString(),rows:1,placeholder:"Enter choice...","resource-id":t.uuid,"resource-variant":t.values[0],mode:e.SupportedMode.TEXT},on:{afterResourceVariantChanged:function(o){return e.handleExistingResourceVariantChangedFor(t.uuid,c,t)}}})]})),e.draftResource?o("resource-variant-text-editor",{key:e.draftResource.uuid,ref:"draftChoice",staticClass:"choices-builder-item",attrs:{label:(e.choiceResourcesOrderedByResourcesList.length+1).toString(),rows:1,placeholder:"Enter choice...","resource-id":e.draftResource.uuid,"resource-variant":e.findOrGenerateStubbedVariantOn(e.draftResource,{language_id:e.activeFlow.languages[0].id,content_type:e.SupportedContentType.TEXT,modes:[e.SupportedMode.TEXT]}),mode:e.SupportedMode.TEXT},on:{beforeResourceVariantChanged:e.addDraftResourceToChoices,afterResourceVariantChanged:function(t){return e.rewriteChoiceKeyFor({resourceId:e.draftResource.uuid,blockId:e.block.uuid})}}}):e._e()],2)},g=[],E=o("c964"),x=(o("96cf"),o("07ac"),o("e260"),o("d3b7"),o("ddb0"),o("31aa")),C=Object(f["e"])("flow"),R=Object(f["e"])("flow/".concat(k["a"])),B=function(e){Object(s["a"])(o,e);var t=Object(l["a"])(o);function o(){var e;Object(a["a"])(this,o);for(var c=arguments.length,r=new Array(c),i=0;i<c;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(u["a"])(Object(n["a"])(e),"block",void 0),Object(u["a"])(Object(n["a"])(e),"draftResource",null),Object(u["a"])(Object(n["a"])(e),"SupportedContentType",b["SupportedContentType"]),Object(u["a"])(Object(n["a"])(e),"SupportedMode",b["SupportedMode"]),Object(u["a"])(Object(n["a"])(e),"findOrGenerateStubbedVariantOn",y["c"]),Object(u["a"])(Object(n["a"])(e),"resources",void 0),Object(u["a"])(Object(n["a"])(e),"resourcesByUuid",void 0),Object(u["a"])(Object(n["a"])(e),"activeFlow",void 0),Object(u["a"])(Object(n["a"])(e),"resource_add",void 0),Object(u["a"])(Object(n["a"])(e),"resource_createWith",void 0),Object(u["a"])(Object(n["a"])(e),"deleteChoiceByResourceIdFrom",void 0),Object(u["a"])(Object(n["a"])(e),"rewriteChoiceKeyFor",void 0),Object(u["a"])(Object(n["a"])(e),"addChoiceByResourceIdTo",void 0),e}return Object(i["a"])(o,[{key:"choiceResourcesOrderedByResourcesList",get:function(){var e=Object.values(this.block.config.choices);return Object(h["intersectionWith"])(this.resources,e,(function(e,t){return e.uuid===t}))}},{key:"created",value:function(){this.generateDraftResource()}},{key:"generateDraftResource",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,(new x["IdGeneratorUuidV4"]).generate();case 3:return e.t1=e.sent,e.t2={uuid:e.t1},e.t3={props:e.t2},e.next=8,e.t0.resource_createWith.call(e.t0,e.t3);case 8:this.draftResource=e.sent;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addDraftResourceToChoices",value:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.draftResource){e.next=3;break}return console.warn("interaction-designer/block-editors/ChoicesBuilder","Unable to add absent draft resource to block choices.",{block:this.block}),e.abrupt("return");case 3:return this.resource_add({resource:this.draftResource}),this.addChoiceByResourceIdTo({blockId:this.block.uuid,resourceId:this.draftResource.uuid}),this.$nextTick((function(){return t.focusInputElFor(Object(h["last"])(t.$refs.choices))})),e.next=8,this.generateDraftResource();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"focusInputElFor",value:function(e){null===e||void 0===e||e.$refs.input.focus()}},{key:"handleExistingResourceVariantChangedFor",value:function(e,t,o){var c=t===this.choiceResourcesOrderedByResourcesList.length-1,r=Object(h["isEmpty"])(Object(h["get"])(o.values[0],"value"));if(c&&r)return this.deleteChoiceByResourceIdFrom({blockId:this.block.uuid,resourceId:e}),void this.focusInputElFor(this.$refs.draftChoice);this.rewriteChoiceKeyFor({resourceId:e,blockId:this.block.uuid}),this.$emit("choiceChanged",{resourceId:e,choiceIndex:t,resource:o})}}]),o}(Object(m["c"])(O["a"]));Object(d["__decorate"])([Object(p["b"])()],B.prototype,"block",void 0),Object(d["__decorate"])([C.State],B.prototype,"resources",void 0),Object(d["__decorate"])([C.Getter],B.prototype,"resourcesByUuid",void 0),Object(d["__decorate"])([C.Getter],B.prototype,"activeFlow",void 0),Object(d["__decorate"])([C.Mutation],B.prototype,"resource_add",void 0),Object(d["__decorate"])([C.Action],B.prototype,"resource_createWith",void 0),Object(d["__decorate"])([R.Action],B.prototype,"deleteChoiceByResourceIdFrom",void 0),Object(d["__decorate"])([R.Action],B.prototype,"rewriteChoiceKeyFor",void 0),Object(d["__decorate"])([R.Action],B.prototype,"addChoiceByResourceIdTo",void 0),B=Object(d["__decorate"])([Object(p["a"])({components:{ResourceVariantTextEditor:_["a"]}})],B);var I=B,T=I,S=o("2877"),F=Object(S["a"])(T,w,g,!1,null,null,null),U=F.exports,L=o("18b0"),V=o("f04e"),G=o("3411"),M=o("1b4e"),A=o("70f0"),D=o("192b"),W=o("510a"),$=o("792f"),P=o("b4ec"),K=Object(f["e"])("flow"),X=Object(f["e"])("flow/".concat(k["a"])),N=Object(f["e"])("builder"),z=function(e){Object(s["a"])(o,e);var t=Object(l["a"])(o);function o(){var e;Object(a["a"])(this,o);for(var c=arguments.length,r=new Array(c),i=0;i<c;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(u["a"])(Object(n["a"])(e),"block",void 0),Object(u["a"])(Object(n["a"])(e),"flow",void 0),Object(u["a"])(Object(n["a"])(e),"showSemanticLabel",!1),Object(u["a"])(Object(n["a"])(e),"SupportedContentType",b["SupportedContentType"]),Object(u["a"])(Object(n["a"])(e),"SupportedMode",b["SupportedMode"]),Object(u["a"])(Object(n["a"])(e),"findOrGenerateStubbedVariantOn",y["c"]),Object(u["a"])(Object(n["a"])(e),"resourcesByUuid",void 0),Object(u["a"])(Object(n["a"])(e),"block_createBlockExitWith",void 0),Object(u["a"])(Object(n["a"])(e),"block_convertExitFormationToUnified",void 0),Object(u["a"])(Object(n["a"])(e),"reflowExitsFromChoices",void 0),Object(u["a"])(Object(n["a"])(e),"handleBranchingTypeChangedToUnified",void 0),Object(u["a"])(Object(n["a"])(e),"isEditable",void 0),e}return Object(i["a"])(o,[{key:"promptResource",get:function(){return this.resourcesByUuid[this.block.config.prompt]}},{key:"handleChoiceChanged",value:function(){var e=this.block,t=e.uuid,o=e.vendor_metadata,c=L["b"].EXIT_PER_CHOICE;o.io_viamo.branchingType===c&&this.reflowExitsFromChoices({blockId:t})}},{key:"reflowExitsWhenSwitchingToBranchingTypeNotUnified",value:function(){var e=this.block,t=e.uuid,o=e.vendor_metadata,c=L["b"].EXIT_PER_CHOICE,r=L["b"].ADVANCED,a=Object(h["includes"])([c,r],o.io_viamo.branchingType);a?this.reflowExitsFromChoices({blockId:t}):this.handleBranchingTypeChangedToUnified({block:this.block})}}]),o}(Object(m["c"])(O["a"]));Object(d["__decorate"])([Object(p["b"])()],z.prototype,"block",void 0),Object(d["__decorate"])([Object(p["b"])()],z.prototype,"flow",void 0),Object(d["__decorate"])([K.Getter],z.prototype,"resourcesByUuid",void 0),Object(d["__decorate"])([K.Action],z.prototype,"block_createBlockExitWith",void 0),Object(d["__decorate"])([K.Action],z.prototype,"block_convertExitFormationToUnified",void 0),Object(d["__decorate"])([X.Action],z.prototype,"reflowExitsFromChoices",void 0),Object(d["__decorate"])([X.Action],z.prototype,"handleBranchingTypeChangedToUnified",void 0),Object(d["__decorate"])([N.Getter],z.prototype,"isEditable",void 0),z=Object(d["__decorate"])([Object(p["a"])({components:{GenericContactPropertyEditor:P["a"],ResourceVariantTextEditor:_["a"],BlockExitSemanticLabelEditor:A["a"],BlockId:$["a"],BlockLabelEditor:G["a"],BlockNameEditor:V["a"],BlockOutputBranchingConfig:L["c"],BlockSemanticLabelEditor:M["a"],ChoicesBuilder:U,FirstBlockEditorButton:D["a"],ResourceEditor:W["a"],Categorization:j["a"]}})],z);var H=z,J=Object(v["d"])(k["a"],k["c"]),q=H,Q=Object(S["a"])(q,c,r,!1,null,null,null);t["default"]=Q.exports},"70f0":function(e,t,o){"use strict";var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("text-editor",{attrs:{"is-editable":e.isEditable,label:e._f("trans")("flow-builder.block-exit-semantic-label"),placeholder:e._f("trans")("flow-builder.enter-block-exit-semantic-label")},model:{value:e.semanticLabel,callback:function(t){e.semanticLabel=t},expression:"semanticLabel"}})],1)},r=[],a=o("f3f3"),i=o("2f62"),n=o("d883"),s=o("4a51"),l={components:{TextEditor:n["a"]},mixins:[s["b"]],props:{isEditable:{default:!0,type:Boolean},exit:{type:Object,required:!0}},computed:{semanticLabel:{get:function(){return this.exit.semantic_label},set:function(e){this.exit.semantic_label=e,this.$emit("commitSemanticLabel",e)}}},methods:Object(a["a"])({},Object(i["c"])("flow",["block_setExitSemanticLabel"]))},u=l,d=o("2877"),b=Object(d["a"])(u,c,r,!1,null,null,null);t["a"]=b.exports},ecef:function(e,t,o){"use strict";o.d(t,"a",(function(){return u})),o.d(t,"f",(function(){return d})),o.d(t,"d",(function(){return b})),o.d(t,"e",(function(){return f})),o.d(t,"b",(function(){return p}));var c=o("d0ff"),r=o("c964"),a=(o("96cf"),o("e260"),o("d3b7"),o("ddb0"),o("99af"),o("b64b"),o("fb6a"),o("e6cf"),o("3ca3"),o("d81d"),o("cca6"),o("a434"),o("a15b"),o("9300")),i=o("31aa"),n=o("8bbf"),s=o.n(n),l=o("2ef0"),u="MobilePrimitives.SelectOneResponse",d=function(){return{}},b={},f={},p={rewriteChoiceKeyFor:function(e,t){var o=e.rootGetters,c=e.dispatch,r=t.resourceId,i=t.blockId,n=o["builder/blocksById"][i];if(null==n)throw new a["ValidationException"]("Unable to find block: ".concat(i));var s=o["flow/resourcesByUuid"][r];if(null==s)throw new a["ValidationException"]("Unable to find resource for choice: ".concat(r));var u=String(Object(l["findKey"])(n.config.choices,(function(e){return e===r})));n.config.choices=Object(l["omit"])(n.config.choices,u),c("addChoiceByResourceIdTo",{blockId:i,resourceId:r})},addChoiceByResourceIdTo:function(e,t){var o=e.rootGetters,c=t.blockId,r=t.resourceId,i=o["builder/blocksById"][c];if(null==i)throw new a["ValidationException"]("Unable to find block: ".concat(c));var n=o["flow/resourcesByUuid"][r];if(null==n)throw new a["ValidationException"]("Unable to find resource for choice: ".concat(r));var u=Object(l["snakeCase"])(Object(l["get"])(n.values[0],"value"))||n.uuid,d=u in i.config.choices,b=d?"-".concat(n.uuid):"";s.a.set(i.config.choices,"".concat(u).concat(b),n.uuid)},deleteChoiceByResourceIdFrom:function(e,t){var o=e.rootGetters,c=t.blockId,r=t.resourceId,i=o["builder/blocksById"][c];if(null==i)throw new a["ValidationException"]("Unable to find block: ".concat(c));var n=String(Object(l["findKey"])(i.config.choices,(function(e){return e===r})));s.a.delete(i.config.choices,n)},reflowExitsFromChoices:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function o(){var n,s,l,u,d,b,f,p;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=e.dispatch,s=e.rootGetters,l=t.blockId,u=s["builder/blocksById"][l],null!=u){o.next=5;break}throw new a["ValidationException"]("Unable to find block: ".concat(l));case 5:return d=u.config.choices,b=u.exits,f=Object.keys(d),p=b.slice(0,-1),o.next=10,Promise.all(f.map(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,o){var c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=p[o]){e.next=8;break}return e.next=3,(new i["IdGeneratorUuidV4"]).generate();case 3:return c=e.sent,e.next=6,n("flow/block_createBlockExitWith",{props:{uuid:c}},{root:!0});case 6:r=e.sent,p.push(r);case 8:Object.assign(p[o],{name:t,test:"block.value = ".concat(o+1)});case 9:case"end":return e.stop()}}),e)})));return function(t,o){return e.apply(this,arguments)}}()));case 10:b.splice.apply(b,[0,b.length-1].concat(Object(c["a"])(p)));case 11:case"end":return o.stop()}}),o)})))()},createWith:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function o(){var c,r,a,n,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c=e.dispatch,r=t.props,o.next=4,c("flow/flow_addBlankResourceForEnabledModesAndLangs",null,{root:!0});case 4:return a=o.sent,o.next=7,(new i["IdGeneratorUuidV4"]).generate();case 7:return o.t0=o.sent,n={uuid:o.t0,name:"Default",default:!0},o.next=11,c("flow/block_createBlockDefaultExitWith",{props:n},{root:!0});case 11:return s=o.sent,o.abrupt("return",Object(l["defaultsDeep"])(r,{type:u,name:"",label:"",semantic_label:"",config:{prompt:a.uuid,choices:{}},exits:[s],tags:[],vendor_metadata:{}}));case 13:case"end":return o.stop()}}),o)})))()},handleBranchingTypeChangedToUnified:function(e,t){var o=e.dispatch,c=t.block;o("flow/block_convertExitFormationToUnified",{blockId:c.uuid,test:h(c)},{root:!0})}};function h(e){var t=Object.keys(e.config.choices);return 0===t.length?(console.warn("Choices are empty for SelectOneBlock, providing `true` by default"),"true"):"OR(".concat(Object(l["map"])(t,(function(e){return'block.value = \\"'.concat(e,'\\"')})).join(","),")")}t["c"]={namespaced:!0,state:d,getters:b,mutations:f,actions:p}}}]);
//# sourceMappingURL=flow-builder.umd.min.6.js.map
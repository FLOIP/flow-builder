(("undefined"!==typeof self?self:this)["webpackJsonpflow_builder"]=("undefined"!==typeof self?self:this)["webpackJsonpflow_builder"]||[]).push([[6,7],{"03d5":function(e,t,o){"use strict";o.r(t),o.d(t,"MobilePrimitives_SelectManyResponseBlock",(function(){return G})),o.d(t,"install",(function(){return A}));var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mobile-primitive-select-many-response-block"},[o("h3",{staticClass:"block-editor-header"},[e._v(" "+e._s(e._f("trans")("flow-builder."+e.block.type))+" ")]),o("fieldset",{attrs:{disabled:!e.isEditable}},[o("block-label-editor",{attrs:{block:e.block},on:{gearClicked:function(t){e.showSemanticLabel=!e.showSemanticLabel}}}),e.showSemanticLabel?o("block-semantic-label-editor",{attrs:{block:e.block}}):e._e(),o("block-name-editor",{attrs:{block:e.block}}),o("div",{staticClass:"prompt-resource"},[e.promptResource?o("resource-editor",{attrs:{label:e._f("trans")("flow-builder.prompt"),resource:e.promptResource,block:e.block,flow:e.flow}}):e._e()],1),o("hr"),o("choices-builder",{attrs:{block:e.block},on:{choiceChanged:e.handleChoiceChanged}}),o("block-output-branching-config",{attrs:{block:e.block,"has-exit-per-choice":!1,"label-class":""},on:{branchingTypeChanged:function(t){return e.reflowExitsWhenSwitchingToBranchingTypeNotUnified()}}}),e._t("extras"),o("categorization",{attrs:{block:e.block}}),o("generic-contact-property-editor",{attrs:{block:e.block}}),o("hr"),o("first-block-editor-button",{attrs:{flow:e.flow,"block-id":e.block.uuid}})],2),o("block-id",{attrs:{block:e.block}})],1)},r=[],a=o("276c"),i=o("2c4c"),n=o("920b"),s=o("92a6"),l=o("fc11"),u=(o("99af"),o("9ab4")),d=o("1b40"),b=o("c964"),f=o("f3f3"),h=(o("96cf"),o("31aa")),p=o("2ef0"),k=o("ecef"),O="MobilePrimitives.SelectManyResponse",j=Object(f["a"])({},k["d"]),v=Object(f["a"])({},k["e"]),m=Object(f["a"])(Object(f["a"])({},k["b"]),{},{createWith:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function o(){var c,r,a,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c=e.dispatch,r=t.props,o.next=4,c("flow/flow_addBlankResourceForEnabledModesAndLangs",null,{root:!0});case 4:return a=o.sent,o.t0=c,o.next=8,(new h["IdGeneratorUuidV4"]).generate();case 8:return o.t1=o.sent,o.t2={uuid:o.t1},o.t3={props:o.t2},o.t4={root:!0},o.next=14,(0,o.t0)("flow/block_createBlockDefaultExitWith",o.t3,o.t4);case 14:return o.t5=o.sent,i=[o.t5],o.abrupt("return",Object(p["defaultsDeep"])(r,{type:O,name:"",label:"",semantic_label:"",exits:i,config:{prompt:a.uuid,choices:{}},vendor_metadata:{},tags:[]}));case 17:case"end":return o.stop()}}),o)})))()}}),g={namespaced:!0,state:k["f"],getters:j,mutations:v,actions:m},_=o("4bb5"),w=o("af98"),y=o("8619"),x=o("18b0"),E=o("5aa7"),C=o("f04e"),R=o("3411"),B=o("1b4e"),I=o("70f0"),T=o("192b"),S=o("510a"),F=o("792f"),U=o("5c47"),L=o("b4ec"),V=(Object(_["e"])("flow/".concat(O)),Object(_["e"])("builder")),G=function(e){Object(n["a"])(o,e);var t=Object(s["a"])(o);function o(){var e;Object(a["a"])(this,o);for(var c=arguments.length,r=new Array(c),n=0;n<c;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),Object(l["a"])(Object(i["a"])(e),"showSemanticLabel",!1),e}return o}(U["default"]);Object(u["__decorate"])([V.Getter],G.prototype,"isEditable",void 0),G=Object(u["__decorate"])([Object(d["a"])({components:{GenericContactPropertyEditor:L["a"],BlockNameEditor:C["a"],BlockLabelEditor:R["a"],BlockOutputBranchingConfig:x["c"],BlockSemanticLabelEditor:B["a"],BlockExitSemanticLabelEditor:I["a"],ChoicesBuilder:E["a"],FirstBlockEditorButton:T["a"],ResourceEditor:S["a"],BlockId:F["a"],Categorization:y["a"]}})],G);var M=G,A=Object(w["d"])(O,g),W=M,D=o("2877"),$=Object(D["a"])(W,c,r,!1,null,null,null);t["default"]=$.exports},"5aa7":function(e,t,o){"use strict";var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"choices-builder form-group"},[o("h4",[e._v(e._s(e._f("trans")("flow-builder.choices")))]),e._l(e.choiceResourcesOrderedByResourcesList,(function(t,c){return[o("resource-variant-text-editor",{key:t.uuid,ref:"choices",refInFor:!0,staticClass:"choices-builder-item",attrs:{label:(c+1).toString(),rows:1,placeholder:"Enter choice...","resource-id":t.uuid,"resource-variant":t.values[0],mode:e.SupportedMode.TEXT},on:{afterResourceVariantChanged:function(o){return e.handleExistingResourceVariantChangedFor(t.uuid,c,t)}}})]})),e.draftResource?o("resource-variant-text-editor",{key:e.draftResource.uuid,ref:"draftChoice",staticClass:"choices-builder-item",attrs:{label:(e.choiceResourcesOrderedByResourcesList.length+1).toString(),rows:1,placeholder:"Enter choice...","resource-id":e.draftResource.uuid,"resource-variant":e.findOrGenerateStubbedVariantOn(e.draftResource,{language_id:e.activeFlow.languages[0].id,content_type:e.SupportedContentType.TEXT,modes:[e.SupportedMode.TEXT]}),mode:e.SupportedMode.TEXT},on:{beforeResourceVariantChanged:e.addDraftResourceToChoices,afterResourceVariantChanged:function(t){return e.rewriteChoiceKeyFor({resourceId:e.draftResource.uuid,blockId:e.block.uuid})}}}):e._e()],2)},r=[],a=o("c964"),i=o("276c"),n=o("e954"),s=o("2c4c"),l=o("920b"),u=o("92a6"),d=o("fc11"),b=(o("96cf"),o("99af"),o("07ac"),o("e260"),o("d3b7"),o("ddb0"),o("9ab4")),f=o("2ef0"),h=o("393e"),p=o("1b40"),k=o("2fe1"),O=o("4a51"),j=o("9300"),v=o("4bb5"),m=o("bb40"),g=o("ecef"),_=o("31aa"),w=Object(v["e"])("flow"),y=Object(v["e"])("flow/".concat(g["a"])),x=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(){var e;Object(i["a"])(this,o);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),Object(d["a"])(Object(s["a"])(e),"block",void 0),Object(d["a"])(Object(s["a"])(e),"draftResource",null),Object(d["a"])(Object(s["a"])(e),"SupportedContentType",j["SupportedContentType"]),Object(d["a"])(Object(s["a"])(e),"SupportedMode",j["SupportedMode"]),Object(d["a"])(Object(s["a"])(e),"findOrGenerateStubbedVariantOn",h["c"]),Object(d["a"])(Object(s["a"])(e),"resources",void 0),Object(d["a"])(Object(s["a"])(e),"resourcesByUuid",void 0),Object(d["a"])(Object(s["a"])(e),"activeFlow",void 0),Object(d["a"])(Object(s["a"])(e),"resource_add",void 0),Object(d["a"])(Object(s["a"])(e),"resource_createWith",void 0),Object(d["a"])(Object(s["a"])(e),"deleteChoiceByResourceIdFrom",void 0),Object(d["a"])(Object(s["a"])(e),"rewriteChoiceKeyFor",void 0),Object(d["a"])(Object(s["a"])(e),"addChoiceByResourceIdTo",void 0),e}return Object(n["a"])(o,[{key:"choiceResourcesOrderedByResourcesList",get:function(){var e=Object.values(this.block.config.choices);return Object(f["intersectionWith"])(this.resources,e,(function(e,t){return e.uuid===t}))}},{key:"created",value:function(){this.generateDraftResource()}},{key:"generateDraftResource",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,(new _["IdGeneratorUuidV4"]).generate();case 3:return e.t1=e.sent,e.t2={uuid:e.t1},e.t3={props:e.t2},e.next=8,e.t0.resource_createWith.call(e.t0,e.t3);case 8:this.draftResource=e.sent;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addDraftResourceToChoices",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.draftResource){e.next=3;break}return console.warn("interaction-designer/block-editors/ChoicesBuilder","Unable to add absent draft resource to block choices.",{block:this.block}),e.abrupt("return");case 3:return this.resource_add({resource:this.draftResource}),this.addChoiceByResourceIdTo({blockId:this.block.uuid,resourceId:this.draftResource.uuid}),this.$nextTick((function(){return t.focusInputElFor(Object(f["last"])(t.$refs.choices))})),e.next=8,this.generateDraftResource();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"focusInputElFor",value:function(e){null===e||void 0===e||e.$refs.input.focus()}},{key:"handleExistingResourceVariantChangedFor",value:function(e,t,o){var c=t===this.choiceResourcesOrderedByResourcesList.length-1,r=Object(f["isEmpty"])(Object(f["get"])(o.values[0],"value"));if(c&&r)return this.deleteChoiceByResourceIdFrom({blockId:this.block.uuid,resourceId:e}),void this.focusInputElFor(this.$refs.draftChoice);this.rewriteChoiceKeyFor({resourceId:e,blockId:this.block.uuid}),this.$emit("choiceChanged",{resourceId:e,choiceIndex:t,resource:o})}}]),o}(Object(k["c"])(O["a"]));Object(b["__decorate"])([Object(p["b"])()],x.prototype,"block",void 0),Object(b["__decorate"])([w.State],x.prototype,"resources",void 0),Object(b["__decorate"])([w.Getter],x.prototype,"resourcesByUuid",void 0),Object(b["__decorate"])([w.Getter],x.prototype,"activeFlow",void 0),Object(b["__decorate"])([w.Mutation],x.prototype,"resource_add",void 0),Object(b["__decorate"])([w.Action],x.prototype,"resource_createWith",void 0),Object(b["__decorate"])([y.Action],x.prototype,"deleteChoiceByResourceIdFrom",void 0),Object(b["__decorate"])([y.Action],x.prototype,"rewriteChoiceKeyFor",void 0),Object(b["__decorate"])([y.Action],x.prototype,"addChoiceByResourceIdTo",void 0),x=Object(b["__decorate"])([Object(p["a"])({components:{ResourceVariantTextEditor:m["a"]}})],x);var E=x,C=E,R=o("2877"),B=Object(R["a"])(C,c,r,!1,null,null,null);t["a"]=B.exports},"5c47":function(e,t,o){"use strict";o.r(t),o.d(t,"MobilePrimitives_SelectOneResponseBlock",(function(){return V})),o.d(t,"install",(function(){return M}));var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mobile-primitive-select-one-response-block"},[o("h3",{staticClass:"block-editor-header"},[e._v(" "+e._s(e._f("trans")("flow-builder."+e.block.type))+" ")]),o("fieldset",{attrs:{disabled:!e.isEditable}},[o("block-label-editor",{attrs:{block:e.block},on:{gearClicked:function(t){e.showSemanticLabel=!e.showSemanticLabel}}}),e.showSemanticLabel?o("block-semantic-label-editor",{attrs:{block:e.block}}):e._e(),o("block-name-editor",{attrs:{block:e.block}}),o("hr"),o("choices-builder",{attrs:{block:e.block},on:{choiceChanged:e.handleChoiceChanged}}),o("block-output-branching-config",{attrs:{block:e.block,"has-exit-per-choice":!0,"label-class":""},on:{branchingTypeChanged:function(t){return e.reflowExitsWhenSwitchingToBranchingTypeNotUnified()}}}),o("div",{staticClass:"prompt-resource"},[e.promptResource?o("resource-editor",{attrs:{label:e._f("trans")("flow-builder.prompt"),resource:e.promptResource,block:e.block,flow:e.flow}}):e._e()],1),e._t("extras"),o("categorization",{attrs:{block:e.block}}),o("generic-contact-property-editor",{attrs:{block:e.block}}),o("hr"),o("first-block-editor-button",{attrs:{flow:e.flow,"block-id":e.block.uuid}})],2),o("block-id",{attrs:{block:e.block}})],1)},r=[],a=o("276c"),i=o("e954"),n=o("2c4c"),s=o("920b"),l=o("92a6"),u=o("fc11"),d=(o("99af"),o("9ab4")),b=o("9300"),f=o("4bb5"),h=o("1b40"),p=o("2ef0"),k=o("ecef"),O=o("4a51"),j=o("8619"),v=o("af98"),m=o("2fe1"),g=o("bb40"),_=o("393e"),w=o("5aa7"),y=o("18b0"),x=o("f04e"),E=o("3411"),C=o("1b4e"),R=o("70f0"),B=o("192b"),I=o("510a"),T=o("792f"),S=o("b4ec"),F=Object(f["e"])("flow"),U=Object(f["e"])("flow/".concat(k["a"])),L=Object(f["e"])("builder"),V=function(e){Object(s["a"])(o,e);var t=Object(l["a"])(o);function o(){var e;Object(a["a"])(this,o);for(var c=arguments.length,r=new Array(c),i=0;i<c;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(u["a"])(Object(n["a"])(e),"block",void 0),Object(u["a"])(Object(n["a"])(e),"flow",void 0),Object(u["a"])(Object(n["a"])(e),"showSemanticLabel",!1),Object(u["a"])(Object(n["a"])(e),"SupportedMode",b["SupportedMode"]),Object(u["a"])(Object(n["a"])(e),"findOrGenerateStubbedVariantOn",_["c"]),Object(u["a"])(Object(n["a"])(e),"resourcesByUuid",void 0),Object(u["a"])(Object(n["a"])(e),"block_createBlockExitWith",void 0),Object(u["a"])(Object(n["a"])(e),"block_convertExitFormationToUnified",void 0),Object(u["a"])(Object(n["a"])(e),"reflowExitsFromChoices",void 0),Object(u["a"])(Object(n["a"])(e),"handleBranchingTypeChangedToUnified",void 0),Object(u["a"])(Object(n["a"])(e),"isEditable",void 0),e}return Object(i["a"])(o,[{key:"promptResource",get:function(){return this.resourcesByUuid[this.block.config.prompt]}},{key:"handleChoiceChanged",value:function(){var e=this.block,t=e.uuid,o=e.vendor_metadata,c=y["b"].EXIT_PER_CHOICE;o.io_viamo.branchingType===c&&this.reflowExitsFromChoices({blockId:t})}},{key:"reflowExitsWhenSwitchingToBranchingTypeNotUnified",value:function(){var e=this.block,t=e.uuid,o=e.vendor_metadata,c=y["b"].EXIT_PER_CHOICE,r=y["b"].ADVANCED,a=Object(p["includes"])([c,r],o.io_viamo.branchingType);a?this.reflowExitsFromChoices({blockId:t}):this.handleBranchingTypeChangedToUnified({block:this.block})}}]),o}(Object(m["c"])(O["a"]));Object(d["__decorate"])([Object(h["b"])()],V.prototype,"block",void 0),Object(d["__decorate"])([Object(h["b"])()],V.prototype,"flow",void 0),Object(d["__decorate"])([F.Getter],V.prototype,"resourcesByUuid",void 0),Object(d["__decorate"])([F.Action],V.prototype,"block_createBlockExitWith",void 0),Object(d["__decorate"])([F.Action],V.prototype,"block_convertExitFormationToUnified",void 0),Object(d["__decorate"])([U.Action],V.prototype,"reflowExitsFromChoices",void 0),Object(d["__decorate"])([U.Action],V.prototype,"handleBranchingTypeChangedToUnified",void 0),Object(d["__decorate"])([L.Getter],V.prototype,"isEditable",void 0),V=Object(d["__decorate"])([Object(h["a"])({components:{GenericContactPropertyEditor:S["a"],ResourceVariantTextEditor:g["a"],BlockExitSemanticLabelEditor:R["a"],BlockId:T["a"],BlockLabelEditor:E["a"],BlockNameEditor:x["a"],BlockOutputBranchingConfig:y["c"],BlockSemanticLabelEditor:C["a"],ChoicesBuilder:w["a"],FirstBlockEditorButton:B["a"],ResourceEditor:I["a"],Categorization:j["a"]}})],V);var G=V,M=Object(v["d"])(k["a"],k["c"]),A=G,W=o("2877"),D=Object(W["a"])(A,c,r,!1,null,null,null);t["default"]=D.exports},"70f0":function(e,t,o){"use strict";var c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("text-editor",{attrs:{"is-editable":e.isEditable,label:e._f("trans")("flow-builder.block-exit-semantic-label"),placeholder:e._f("trans")("flow-builder.enter-block-exit-semantic-label")},model:{value:e.semanticLabel,callback:function(t){e.semanticLabel=t},expression:"semanticLabel"}})],1)},r=[],a=o("f3f3"),i=o("2f62"),n=o("d883"),s=o("4a51"),l={components:{TextEditor:n["a"]},mixins:[s["b"]],props:{isEditable:{default:!0,type:Boolean},exit:{type:Object,required:!0}},computed:{semanticLabel:{get:function(){return this.exit.semantic_label},set:function(e){this.exit.semantic_label=e,this.$emit("commitSemanticLabel",e)}}},methods:Object(a["a"])({},Object(i["c"])("flow",["block_setExitSemanticLabel"]))},u=l,d=o("2877"),b=Object(d["a"])(u,c,r,!1,null,null,null);t["a"]=b.exports},ecef:function(e,t,o){"use strict";o.d(t,"a",(function(){return u})),o.d(t,"f",(function(){return d})),o.d(t,"d",(function(){return b})),o.d(t,"e",(function(){return f})),o.d(t,"b",(function(){return h}));var c=o("d0ff"),r=o("c964"),a=(o("96cf"),o("e260"),o("d3b7"),o("ddb0"),o("99af"),o("b64b"),o("fb6a"),o("e6cf"),o("3ca3"),o("d81d"),o("cca6"),o("a434"),o("a15b"),o("9300")),i=o("31aa"),n=o("8bbf"),s=o.n(n),l=o("2ef0"),u="MobilePrimitives.SelectOneResponse",d=function(){return{}},b={},f={},h={rewriteChoiceKeyFor:function(e,t){var o=e.rootGetters,c=e.dispatch,r=t.resourceId,i=t.blockId,n=o["builder/blocksById"][i];if(null==n)throw new a["ValidationException"]("Unable to find block: ".concat(i));var s=o["flow/resourcesByUuid"][r];if(null==s)throw new a["ValidationException"]("Unable to find resource for choice: ".concat(r));var u=String(Object(l["findKey"])(n.config.choices,(function(e){return e===r})));n.config.choices=Object(l["omit"])(n.config.choices,u),c("addChoiceByResourceIdTo",{blockId:i,resourceId:r})},addChoiceByResourceIdTo:function(e,t){var o=e.rootGetters,c=t.blockId,r=t.resourceId,i=o["builder/blocksById"][c];if(null==i)throw new a["ValidationException"]("Unable to find block: ".concat(c));var n=o["flow/resourcesByUuid"][r];if(null==n)throw new a["ValidationException"]("Unable to find resource for choice: ".concat(r));var u=Object(l["snakeCase"])(Object(l["get"])(n.values[0],"value"))||n.uuid,d=u in i.config.choices,b=d?"-".concat(n.uuid):"";s.a.set(i.config.choices,"".concat(u).concat(b),n.uuid)},deleteChoiceByResourceIdFrom:function(e,t){var o=e.rootGetters,c=t.blockId,r=t.resourceId,i=o["builder/blocksById"][c];if(null==i)throw new a["ValidationException"]("Unable to find block: ".concat(c));var n=String(Object(l["findKey"])(i.config.choices,(function(e){return e===r})));s.a.delete(i.config.choices,n)},reflowExitsFromChoices:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function o(){var n,s,l,u,d,b,f,h;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=e.dispatch,s=e.rootGetters,l=t.blockId,u=s["builder/blocksById"][l],null!=u){o.next=5;break}throw new a["ValidationException"]("Unable to find block: ".concat(l));case 5:return d=u.config.choices,b=u.exits,f=Object.keys(d),h=b.slice(0,-1),o.next=10,Promise.all(f.map(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,o){var c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=h[o]){e.next=8;break}return e.next=3,(new i["IdGeneratorUuidV4"]).generate();case 3:return c=e.sent,e.next=6,n("flow/block_createBlockExitWith",{props:{uuid:c}},{root:!0});case 6:r=e.sent,h.push(r);case 8:Object.assign(h[o],{name:t,test:"block.value = ".concat(o+1)});case 9:case"end":return e.stop()}}),e)})));return function(t,o){return e.apply(this,arguments)}}()));case 10:b.splice.apply(b,[0,b.length-1].concat(Object(c["a"])(h)));case 11:case"end":return o.stop()}}),o)})))()},createWith:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function o(){var c,r,a,n;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c=e.dispatch,r=t.props,o.next=4,c("flow/flow_addBlankResourceForEnabledModesAndLangs",null,{root:!0});case 4:return a=o.sent,o.t0=c,o.next=8,(new i["IdGeneratorUuidV4"]).generate();case 8:return o.t1=o.sent,o.t2={uuid:o.t1},o.t3={props:o.t2},o.t4={root:!0},o.next=14,(0,o.t0)("flow/block_createBlockDefaultExitWith",o.t3,o.t4);case 14:return o.t5=o.sent,n=[o.t5],o.abrupt("return",Object(l["defaultsDeep"])(r,{type:u,name:"",label:"",semantic_label:"",config:{prompt:a.uuid,choices:{}},exits:n,tags:[],vendor_metadata:{}}));case 17:case"end":return o.stop()}}),o)})))()},handleBranchingTypeChangedToUnified:function(e,t){var o=e.dispatch,c=t.block;o("flow/block_convertExitFormationToUnified",{blockId:c.uuid,test:p(c)},{root:!0})}};function p(e){var t=Object.keys(e.config.choices);return 0===t.length?(console.warn("Choices are empty for SelectOneBlock, providing `true` by default"),"true"):"OR(".concat(Object(l["map"])(t,(function(e){return"block.value = '".concat(e,"'")})).join(","),")")}t["c"]={namespaced:!0,state:d,getters:b,mutations:f,actions:h}}}]);
//# sourceMappingURL=flow-builder.umd.min.6.js.map